<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŸå ‚ç£åŠ›é“¾æ¥çˆ¬è™«</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #0f1117;
            color: #c9d1d9;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', sans-serif;
            transition: background-color 0.3s ease;
        }
        .container-fluid {
            max-width: 1200px;
            margin-top: 40px;
        }
        .card {
            background-color: #161b22;
            border: 1px solid #30363d;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        .card:hover {
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.5);
            transform: translateY(-2px);
        }
        .card-header {
            background-color: #1f2328;
            border-bottom: 1px solid #30363d;
            border-radius: 12px 12px 0 0 !important;
        }
        .card-body {
            color: #c9d1d9;
        }
        .status-box {
            min-height: 180px;
        }
        .progress {
            height: 24px;
            font-size: 12px;
            background-color: #21262d;
            border-radius: 12px;
            overflow: hidden;
        }
        .progress-bar {
            background-color: #238636;
            transition: width 0.5s ease-in-out;
            animation: progress-animation 2s ease-in-out infinite;
        }
        @keyframes progress-animation {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }
        .btn-group {
            margin-bottom: 25px;
        }
        .form-control {
            background-color: #0d1117;
            border: 1px solid #30363d;
            color: #c9d1d9;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        .form-control:focus {
            background-color: #0d1117;
            border-color: #238636;
            color: #c9d1d9;
            box-shadow: 0 0 0 0.2rem rgba(35, 134, 54, 0.25);
        }
        .form-label {
            color: #8b949e;
            font-weight: 500;
        }
        .form-range {
            background-color: transparent;
        }
        .form-text {
            color: #8b949e;
        }
        pre {
            background-color: #161b22;
            border: 1px solid #30363d;
            color: #c9d1d9;
            border-radius: 8px;
        }
        /* æŒ‰é’®æ ·å¼ */
        .btn {
            border: 1px solid transparent;
            border-radius: 8px;
            padding: 10px 20px;
            font-weight: 500;
            transition: all 0.3s ease;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }
        .btn:hover::before {
            left: 100%;
        }
        .btn-primary {
            background-color: #238636;
            color: #ffffff;
        }
        .btn-primary:hover {
            background-color: #2ea043;
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(35, 134, 54, 0.4);
        }
        .btn-success {
            background-color: #238636;
        }
        .btn-success:hover {
            background-color: #2ea043;
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(35, 134, 54, 0.4);
        }
        .btn-danger {
            background-color: #da3633;
        }
        .btn-danger:hover {
            background-color: #f85149;
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(218, 54, 51, 0.4);
        }
        .btn-info {
            background-color: #1f6feb;
        }
        .btn-info:hover {
            background-color: #316dca;
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(31, 111, 235, 0.4);
        }
        .btn-secondary {
            background-color: #563d7c;
        }
        .btn-secondary:hover {
            background-color: #6f42c1;
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(86, 61, 124, 0.4);
        }
        .btn:disabled {
            background-color: #30363d;
            color: #8b949e;
            transform: none;
            box-shadow: none;
            cursor: not-allowed;
        }
        .btn:disabled::before {
            display: none;
        }
        /* è¾“å…¥æ¡†å’Œæ»‘å—æ ·å¼ */
        .form-range::-webkit-slider-thumb {
            background-color: #238636;
            transition: all 0.3s ease;
        }
        .form-range::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 0 10px rgba(35, 134, 54, 0.5);
        }
        .form-range::-moz-range-thumb {
            background-color: #238636;
            transition: all 0.3s ease;
        }
        .form-range::-moz-range-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 0 10px rgba(35, 134, 54, 0.5);
        }
        /* åˆ—è¡¨æ ·å¼ */
        .list-group {
            background-color: #161b22;
            border-radius: 8px;
        }
        .list-group-item {
            background-color: #0d1117;
            border: 1px solid #30363d;
            color: #c9d1d9;
            transition: all 0.3s ease;
        }
        .list-group-item:hover {
            background-color: #161b22;
            transform: translateX(5px);
        }
        /* é¡µè„šæ ·å¼ */
        footer {
            color: #8b949e;
            margin-top: 60px;
            padding: 20px 0;
            border-top: 1px solid #30363d;
        }
        
        /* è‡ªå®šä¹‰å·¥å…·ç±» */
        .bg-secondary {
            background-color: #21262d !important;
        }
        .bg-secondary.bg-opacity-10 {
            background-color: rgba(33, 38, 45, 0.1) !important;
        }
        .text-success {
            color: #238636 !important;
        }
        .text-info {
            color: #1f6feb !important;
        }
        .text-muted {
            color: #8b949e !important;
        }
        
        /* ç£åŠ›é“¾æ¥å’Œåœ°å€é¡¹åŠ¨ç”» */
        .magnet-item, .url-item {
            transition: all 0.3s ease;
            animation: fadeIn 0.5s ease-in-out;
        }
        .magnet-item:hover, .url-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* å“åº”å¼ç½‘æ ¼å¸ƒå±€ */
        @media (min-width: 768px) {
            .grid {
                display: grid;
            }
            .grid-cols-1 {
                grid-template-columns: repeat(1, minmax(0, 1fr));
            }
            .grid-cols-2 {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }
        
        /* é—´è·å·¥å…·ç±» */
        .gap-4 {
            gap: 1rem;
        }
        
        /* ä¼˜åŒ–æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #161b22;
        }
        ::-webkit-scrollbar-thumb {
            background: #30363d;
            border-radius: 5px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #484f58;
        }
    </style>
</head>
<body>
    <div class="container-fluid px-3 px-md-5">
        <div class="card shadow-lg mb-5">
            <div class="card-header bg-primary text-white text-center">
                <h1 class="mb-2">æŸå ‚çˆ¬è™«ï¼ˆä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼‰</h1>
                <p class="mb-0">çˆ¬å–æŸå ‚æŒ‡å®šè®ºå›çš„ç£åŠ›é“¾æ¥å’Œå›¾ç‰‡</p>
            </div>
            
            <div class="card-body p-4 p-lg-5">
                <!-- ä¸»å†…å®¹åŒºåŸŸ - å“åº”å¼ç½‘æ ¼å¸ƒå±€ -->
                <div class="row">
                    <!-- å·¦ä¾§ï¼šçˆ¬å–å‚æ•°å’ŒçŠ¶æ€ -->
                    <div class="col-md-7 col-lg-8 mb-5 mb-md-0">
                        <!-- çˆ¬å–å‚æ•°è®¾ç½® -->
                        <div class="mb-5">
                            <h2 class="h4 mb-4 text-primary">çˆ¬å–å‚æ•°è®¾ç½®</h2>
                            <form id="crawlForm" class="space-y-4">
                                <div class="mb-4">
                                    <label for="baseUrl" class="form-label mb-2">åŸºç¡€URL</label>
                                    <input type="text" class="form-control" id="baseUrl" name="base_url" value="https://btd5.thsf7.net" placeholder="è¯·è¾“å…¥åŸºç¡€URL">
                                    <small class="form-text text-muted mt-1">è¯·è¾“å…¥è¦çˆ¬å–çš„ç½‘ç«™åŸºç¡€URLï¼ˆå¦‚ï¼šhttps://example.comï¼‰</small>
                                </div>
                                <div class="mb-4">
                                    <label for="forumId" class="form-label mb-2">è®ºå›æ¿å—ID</label>
                                    <input type="text" class="form-control" id="forumId" name="forum_id" value="103" placeholder="é»˜è®¤: 103">
                                    <small class="form-text text-muted mt-1">è¯·è¾“å…¥è¦çˆ¬å–çš„è®ºå›æ¿å—ID</small>
                                </div>
                                <div class="mb-4">
                                    <label for="pages" class="form-label mb-2">çˆ¬å–é¡µæ•°: <span id="pagesValue" class="text-primary">1</span></label>
                                    <input type="range" class="form-range" id="pages" name="pages" value="1" min="1" max="20" step="1">
                                    <small class="form-text text-muted mt-1">è¯·æ‹–åŠ¨æ»‘å—é€‰æ‹©è¦çˆ¬å–çš„é¡µæ•° (1-20)</small>
                                </div>
                                <div class="mb-5">
                                    <label for="cookie" class="form-label mb-2">Cookieè®¾ç½®</label>
                                    <div class="mb-3">
                                        <textarea class="form-control" id="cookie" name="cookie" rows="4" placeholder="è¯·è¾“å…¥æ‚¨çš„Cookieå€¼...">cPNj_2132_saltkey=KhbhYZHU; cPNj_2132_lastvisit=1764373583; cPNj_2132_atarget=1; cPNj_2132_lastfp=4a8b2ed4d942c6bc0f64e1021691ecc7; sl-session=i7J8TKI4MGnxQkMSruQiWQ==; _safe=LFzQp0o00mj8Z2I0; cPNj_2132_viewid=tid_3164292; cPNj_2132_lastact=1764681618%09forum.php%09forumdisplay; cPNj_2132_st_t=0%7C1764681618%7Cd50ef50766f62b42e905a599b4b9a60e; cPNj_2132_forum_lastvisit=D_95_1764416438D_151_1764419725D_37_1764419885D_141_1764420846D_103_1764681618; cPNj_2132_visitedfid=103D141D37D151D95</textarea>
                                    </div>
                                    <button type="button" id="updateCookieBtn" class="btn btn-secondary mb-4">ç¡®è®¤æ›´æ–°Cookie</button>
                                    <div class="card mb-3">
                                        <div class="card-header text-white">
                                        å½“å‰ä½¿ç”¨çš„Cookie
                                    </div>
                                        <div class="card-body p-3">
                                            <pre id="currentCookieDisplay" class="p-2 rounded overflow-auto" style="max-height: 120px; margin-bottom: 0;">cPNj_2132_saltkey=KhbhYZHU; cPNj_2132_lastvisit=1764373583; cPNj_2132_atarget=1; cPNj_2132_lastfp=4a8b2ed4d942c6bc0f64e1021691ecc7; sl-session=i7J8TKI4MGnxQkMSruQiWQ==; _safe=LFzQp0o00mj8Z2I0; cPNj_2132_viewid=tid_3164292; cPNj_2132_lastact=1764681618%09forum.php%09forumdisplay; cPNj_2132_st_t=0%7C1764681618%7Cd50ef50766f62b42e905a599b4b9a60e; cPNj_2132_forum_lastvisit=D_95_1764416438D_151_1764419725D_37_1764419885D_141_1764420846D_103_1764681618; cPNj_2132_visitedfid=103D141D37D151D95</pre>
                                        </div>
                                    </div>
                                    <small class="form-text text-muted">è¯·è¾“å…¥æ‚¨çš„Cookieå€¼ï¼Œç”¨äºè®¿é—®ç½‘ç«™</small>
                                </div>
                                <div class="mb-5">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="saveImages" name="save_images" value="true">
                                        <label class="form-check-label" for="saveImages">ä¿å­˜çˆ¬å–åˆ°çš„å›¾ç‰‡</label>
                                    </div>
                                    <small class="form-text text-muted mt-1">å‹¾é€‰åï¼Œçˆ¬è™«å°†åŒæ—¶ä¿å­˜ç½‘é¡µä¸­çš„å›¾ç‰‡åˆ° data/figures æ–‡ä»¶å¤¹</small>
                                </div>
                                
                                <!-- å›¾ç‰‡ä¸‹è½½Cookieè®¾ç½® -->
                                <div class="mb-5">
                                    <h3 class="h6 mb-3 text-primary">å›¾ç‰‡ä¸‹è½½Cookieè®¾ç½®</h3>
                                    <div class="mb-3">
                                        <textarea class="form-control" id="imageCookie" rows="3" placeholder="è¯·è¾“å…¥å›¾ç‰‡ä¸‹è½½ä¸“ç”¨Cookieå€¼..."></textarea>
                                    </div>
                                    <button type="button" id="updateImageCookieBtn" class="btn btn-secondary mb-4">ç¡®è®¤æ›´æ–°å›¾ç‰‡ä¸‹è½½Cookie</button>
                                    <div class="card mb-3">
                                        <div class="card-header text-white">
                                            å½“å‰å›¾ç‰‡ä¸‹è½½Cookie
                                        </div>
                                        <div class="card-body p-3">
                                            <pre id="currentImageCookieDisplay" class="p-2 rounded overflow-auto" style="max-height: 100px; margin-bottom: 0;"></pre>
                                        </div>
                                    </div>
                                    <small class="form-text text-muted">è¯·è¾“å…¥å›¾ç‰‡ä¸‹è½½ä¸“ç”¨Cookieå€¼ï¼Œç”¨äºçˆ¬å–å›¾ç‰‡æ—¶çš„èº«ä»½éªŒè¯</small>
                                </div>
                                <div class="d-flex flex-wrap gap-3">
                                    <button type="submit" id="startBtn" class="btn btn-success btn-lg">å¼€å§‹çˆ¬å–</button>
                                    <button type="button" id="pauseBtn" class="btn btn-warning btn-lg" style="display: none;">æš‚åœçˆ¬å–</button>
                                    <button type="button" id="resumeBtn" class="btn btn-info btn-lg" style="display: none;">ç»§ç»­çˆ¬å–</button>
                                    <button type="button" id="stopBtn" class="btn btn-danger btn-lg" style="display: none;">åœæ­¢çˆ¬å–</button>
                                    <button type="button" id="downloadBtn" class="btn btn-primary btn-lg" disabled>ä¸‹è½½ç£åŠ›é“¾æ¥</button>
                                    <button type="button" id="downloadUrlsBtn" class="btn btn-info btn-lg" disabled>ä¸‹è½½çˆ¬å–åœ°å€</button>
                                </div>
                            </form>
                        </div>

                        <!-- çˆ¬å–çŠ¶æ€æ˜¾ç¤º -->
                        <div class="mb-5">
                            <h2 class="h4 mb-3 text-primary">çˆ¬å–çŠ¶æ€</h2>
                            <div class="card status-box shadow-sm">
                                <div class="card-body pb-2">
                                    <!-- ä¸»è¦çŠ¶æ€ä¿¡æ¯ -->
                                    <div class="row row-cols-1 row-cols-md-5 gap-2 mb-3">
                                        <div class="bg-secondary bg-opacity-10 p-2 rounded">
                                            <strong class="text-muted">çŠ¶æ€:</strong> <span id="statusText" class="text-success">å°±ç»ª</span>
                                        </div>
                                        <div class="bg-secondary bg-opacity-10 p-2 rounded">
                                            <strong class="text-muted">ç£åŠ›æ•°:</strong> <span id="magnetCount" class="text-info">0</span>
                                        </div>
                                        <div class="bg-secondary bg-opacity-10 p-2 rounded">
                                            <strong class="text-muted">å›¾ç‰‡æ•°:</strong> <span id="imageCount" class="text-info">0</span>
                                        </div>
                                        <div class="bg-secondary bg-opacity-10 p-2 rounded">
                                            <strong class="text-muted">é¡µé¢:</strong> <span id="currentPage">0</span> / <span id="totalPages">0</span>
                                        </div>
                                        <div class="bg-secondary bg-opacity-10 p-2 rounded">
                                            <strong class="text-muted">è¿›åº¦:</strong> <span id="progressText">0%</span>
                                        </div>
                                    </div>
                                    
                                    <!-- å½“å‰çˆ¬å–åœ°å€ -->
                                    <div class="mb-3">
                                        <div class="text-sm text-muted">å½“å‰åœ°å€:</div>
                                        <div id="currentUrl" class="text-break bg-secondary bg-opacity-10 p-2 rounded text-sm"></div>
                                    </div>
                                    
                                    <!-- æ–‡ä»¶ä¿¡æ¯ -->
                                    <div class="row row-cols-1 row-cols-md-3 gap-2 mb-3">
                                        <div class="bg-secondary bg-opacity-10 p-2 rounded">
                                            <div class="text-sm text-muted">ç£åŠ›æ–‡ä»¶:</div>
                                            <div id="magnetFileName" class="text-break text-sm">æœªç”Ÿæˆ</div>
                                        </div>
                                        <div class="bg-secondary bg-opacity-10 p-2 rounded">
                                            <div class="text-sm text-muted">åœ°å€æ–‡ä»¶:</div>
                                            <div id="urlFileName" class="text-break text-sm">æœªç”Ÿæˆ</div>
                                        </div>
                                        <div class="bg-secondary bg-opacity-10 p-2 rounded">
                                            <div class="text-sm text-muted">å›¾ç‰‡ç›®å½•:</div>
                                            <div id="figuresDir" class="text-break text-sm text-muted">æœªç”Ÿæˆ</div>
                                        </div>
                                    </div>
                                    
                                    <!-- è¿›åº¦æ¡ -->
                                    <div class="progress mb-3">
                                        <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                            0%
                                        </div>
                                    </div>
                                    
                                    <!-- æ¶ˆæ¯ -->
                                    <div>
                                        <div class="text-sm text-muted">æ¶ˆæ¯:</div>
                                        <div id="messageText" class="bg-secondary bg-opacity-10 p-2 rounded text-sm">ç­‰å¾…å¼€å§‹...</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- å†å²è®°å½• -->
                        <div>
                            <h2 class="h4 mb-4 text-primary">çˆ¬å–å†å²</h2>
                            <div class="card shadow-sm">
                                <div class="card-body">
                                    <ul id="historyList" class="list-group">
                                        <li class="list-group-item text-muted">æš‚æ— çˆ¬å–å†å²</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- å³ä¾§ï¼šç»“æœæ˜¾ç¤º -->
                    <div class="col-md-5 col-lg-4">
                        <!-- ç£åŠ›é“¾æ¥æ˜¾ç¤º -->
                        <div class="card mb-4 shadow-sm">
                            <div class="card-header bg-primary text-white">
                                <h2 class="h5 mb-0">ç£åŠ›é“¾æ¥ (å…± <span id="magnetCountDisplay">0</span> æ¡)</h2>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <input type="text" id="magnetFilter" class="form-control" placeholder="è¿‡æ»¤ç£åŠ›é“¾æ¥...">
                                </div>
                                <div class="d-flex justify-content-end mb-2">
                                    <button id="copyAllMagnets" class="btn btn-sm btn-primary">å¤åˆ¶å…¨éƒ¨</button>
                                </div>
                                <div id="magnetLinksDisplay" class="bg-secondary bg-opacity-10 p-2 rounded display-box overflow-auto" style="max-height: 300px;">
                                    <p class="text-muted">ç­‰å¾…çˆ¬å–...</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- çˆ¬å–åœ°å€æ˜¾ç¤º -->
                        <div class="card shadow-sm">
                            <div class="card-header bg-info text-white">
                                <h2 class="h5 mb-0">çˆ¬å–åœ°å€ (å…± <span id="urlsCountDisplay">0</span> æ¡)</h2>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <input type="text" id="urlFilter" class="form-control" placeholder="è¿‡æ»¤çˆ¬å–åœ°å€...">
                                </div>
                                <div class="d-flex justify-content-end mb-2">
                                    <button id="copyAllUrls" class="btn btn-sm btn-info">å¤åˆ¶å…¨éƒ¨</button>
                                </div>
                                <div id="crawlUrlsDisplay" class="bg-secondary bg-opacity-10 p-2 rounded display-box overflow-auto" style="max-height: 300px;">
                                    <p class="text-muted">ç­‰å¾…çˆ¬å–...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ä½¿ç”¨è¯´æ˜å’Œå¸®åŠ©ä¿¡æ¯ -->
        <div class="card shadow-lg mb-5">
            <div class="card-header bg-primary text-white">
                <h2 class="h5 mb-0">ä½¿ç”¨è¯´æ˜</h2>
            </div>
            <div class="card-body">
                <div class="accordion" id="helpAccordion">
                    <div class="accordion-item">
                        <h6 class="accordion-header" id="headingOne">
                            <button class="accordion-button collapsed bg-transparent text-success" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                                ğŸ¯ åŸºæœ¬ä½¿ç”¨
                            </button>
                        </h6>
                        <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#helpAccordion">
                            <div class="accordion-body">
                                <ul class="mb-0">
                                    <li>è®¾ç½®çˆ¬å–å‚æ•°ï¼ŒåŒ…æ‹¬åŸºç¡€URLã€è®ºå›æ¿å—IDå’Œçˆ¬å–é¡µæ•°</li>
                                    <li>æ ¹æ®éœ€è¦æ›´æ–°Cookieè®¾ç½®ä»¥è®¿é—®å—é™å†…å®¹</li>
                                    <li>ç‚¹å‡»"å¼€å§‹çˆ¬å–"æŒ‰é’®å¯åŠ¨çˆ¬å–ä»»åŠ¡</li>
                                    <li>çˆ¬å–è¿‡ç¨‹ä¸­å¯ä»¥éšæ—¶æš‚åœæˆ–ç»§ç»­</li>
                                    <li>çˆ¬å–å®Œæˆåï¼Œç»“æœå°†æ˜¾ç¤ºåœ¨å³ä¾§é¢æ¿ä¸­</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h6 class="accordion-header" id="headingTwo">
                            <button class="accordion-button collapsed bg-transparent text-info" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                âš™ï¸ åŠŸèƒ½è¯´æ˜
                            </button>
                        </h6>
                        <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#helpAccordion">
                            <div class="accordion-body">
                                <ul class="mb-0">
                                    <li><strong>å“åº”å¼å¸ƒå±€</strong>ï¼šé€‚é…ä¸åŒå±å¹•å°ºå¯¸ï¼Œå¤§å±å·¦å³åˆ†æ ï¼Œå°å±ä¸Šä¸‹å †å </li>
                                    <li><strong>æš‚åœ/ç»§ç»­</strong>ï¼šçµæ´»æ§åˆ¶çˆ¬å–è¿‡ç¨‹ï¼Œé¿å…ä¸å¿…è¦çš„ç½‘ç»œè¯·æ±‚</li>
                                    <li><strong>è¿‡æ»¤åŠŸèƒ½</strong>ï¼šå¿«é€Ÿç­›é€‰ç£åŠ›é“¾æ¥å’Œçˆ¬å–åœ°å€</li>
                                    <li><strong>ä¸€é”®å¤åˆ¶</strong>ï¼šæ”¯æŒå•ä¸ªå¤åˆ¶å’Œæ‰¹é‡å¤åˆ¶ç»“æœ</li>
                                    <li><strong>å®æ—¶è¿›åº¦</strong>ï¼šæ˜¾ç¤ºçˆ¬å–è¿›åº¦ã€å½“å‰é¡µé¢å’Œå·²è·å–ç»“æœæ•°é‡</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h6 class="accordion-header" id="headingThree">
                            <button class="accordion-button collapsed bg-transparent text-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                â“ å¸¸è§é—®é¢˜
                            </button>
                        </h6>
                        <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#helpAccordion">
                            <div class="accordion-body">
                                <ul class="mb-0">
                                    <li><strong>çˆ¬å–é€Ÿåº¦æ…¢æ€ä¹ˆåŠï¼Ÿ</strong>ï¼šå¯ä»¥å‡å°‘çˆ¬å–æ•°é‡æˆ–è°ƒæ•´é¡µé¢èŒƒå›´</li>
                                    <li><strong>çˆ¬å–å¤±è´¥æ€ä¹ˆè§£å†³ï¼Ÿ</strong>ï¼šæ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œç¡®ä¿ç›®æ ‡ç½‘ç«™å¯è®¿é—®</li>
                                    <li><strong>ç»“æœä¸å®Œæ•´ï¼Ÿ</strong>ï¼šéƒ¨åˆ†é¡µé¢å¯èƒ½éœ€è¦ç™»å½•æˆ–æœ‰åçˆ¬æœºåˆ¶</li>
                                    <li><strong>å¦‚ä½•å¯¼å‡ºç»“æœï¼Ÿ</strong>ï¼šå¯ä»¥ç‚¹å‡»"å¤åˆ¶å…¨éƒ¨"æŒ‰é’®ï¼Œç„¶åç²˜è´´åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h6 class="accordion-header" id="headingFour">
                            <button class="accordion-button collapsed bg-transparent text-warning" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                                ğŸ“ æ³¨æ„äº‹é¡¹
                            </button>
                        </h6>
                        <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#helpAccordion">
                            <div class="accordion-body">
                                <ul class="mb-0">
                                    <li>è¯·éµå®ˆç›®æ ‡ç½‘ç«™çš„çˆ¬è™«åè®®ï¼ˆrobots.txtï¼‰</li>
                                    <li>ä¸è¦è¿‡åº¦çˆ¬å–ï¼Œé¿å…ç»™ç›®æ ‡ç½‘ç«™é€ æˆå‹åŠ›</li>
                                    <li>çˆ¬å–ç»“æœä»…ç”¨äºå­¦ä¹ å’Œç ”ç©¶ç›®çš„</li>
                                    <li>å®šæœŸæ¸…ç†çˆ¬å–ç»“æœæ–‡ä»¶ï¼Œé¿å…å ç”¨è¿‡å¤šç£ç›˜ç©ºé—´</li>
                                    <li>ä½¿ç”¨å‰è¯·ç¡®ä¿å·²å®‰è£…æ‰€æœ‰ä¾èµ–åŒ…</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- é¡µè„š -->
        <footer class="mt-4 text-center text-muted">
            <p>Â© 2025 æŸå ‚ç£åŠ›é“¾æ¥çˆ¬è™« - ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨</p>
        </footer>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            const crawlForm = document.getElementById('crawlForm');
            const startBtn = document.getElementById('startBtn');
            const pauseBtn = document.getElementById('pauseBtn');
            const resumeBtn = document.getElementById('resumeBtn');
            const stopBtn = document.getElementById('stopBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const downloadUrlsBtn = document.getElementById('downloadUrlsBtn');
            const statusText = document.getElementById('statusText');
            const magnetCount = document.getElementById('magnetCount');
            const imageCount = document.getElementById('imageCount');
            const currentPage = document.getElementById('currentPage');
            const totalPages = document.getElementById('totalPages');
            const progressText = document.getElementById('progressText');
            const progressBar = document.getElementById('progressBar');
            const messageText = document.getElementById('messageText');
            const historyList = document.getElementById('historyList');
            const figuresDirDisplay = document.getElementById('figuresDir');
            const magnetFileNameDisplay = document.getElementById('magnetFileName');
            const urlFileNameDisplay = document.getElementById('urlFileName');
            const pagesSlider = document.getElementById('pages');
            const pagesValue = document.getElementById('pagesValue');
            const updateCookieBtn = document.getElementById('updateCookieBtn');
            const cookieInput = document.getElementById('cookie');
            const currentCookieDisplay = document.getElementById('currentCookieDisplay');
            
            // è¿‡æ»¤å’Œå¤åˆ¶ç›¸å…³å…ƒç´ 
            const magnetFilter = document.getElementById('magnetFilter');
            const urlFilter = document.getElementById('urlFilter');
            const copyAllMagnets = document.getElementById('copyAllMagnets');
            const copyAllUrls = document.getElementById('copyAllUrls');
            
            // æ›´æ–°æ»‘å—æ˜¾ç¤ºå€¼
            pagesSlider.addEventListener('input', function() {
                pagesValue.textContent = this.value;
            });
            
            // æ›´æ–°CookieæŒ‰é’®ç‚¹å‡»äº‹ä»¶
            updateCookieBtn.addEventListener('click', function() {
                const customCookie = cookieInput.value.trim();
                
                if (!customCookie) {
                    alert('è¯·è¾“å…¥Cookieå€¼ï¼');
                    return;
                }
                
                // å‘é€è¯·æ±‚æ›´æ–°Cookie
                fetch('/update_cookie', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: new URLSearchParams({
                        'cookie': customCookie
                    })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        // æ›´æ–°æ˜¾ç¤ºçš„å½“å‰Cookie
                        currentCookieDisplay.textContent = customCookie;
                        alert('Cookieæ›´æ–°æˆåŠŸï¼');
                    } else {
                        alert('Cookieæ›´æ–°å¤±è´¥: ' + data.message);
                    }
                })
                .catch(error => {
                    alert('è¯·æ±‚å¤±è´¥: ' + error.message);
                });
            });
            
            // é¡µé¢åŠ è½½æ—¶è·å–å½“å‰Cookie
            fetch('/get_current_cookie')
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    cookieInput.value = data.cookie;
                    currentCookieDisplay.textContent = data.cookie;
                }
            })
            .catch(error => {
                console.error('è·å–Cookieå¤±è´¥:', error);
            });

            // è·å–å›¾ç‰‡ä¸‹è½½Cookieçš„DOMå…ƒç´ 
            const imageCookieInput = document.getElementById('imageCookie');
            const updateImageCookieBtn = document.getElementById('updateImageCookieBtn');
            const currentImageCookieDisplay = document.getElementById('currentImageCookieDisplay');

            // é¡µé¢åŠ è½½æ—¶è·å–å½“å‰å›¾ç‰‡ä¸‹è½½Cookie
            fetch('/get_image_cookie')
            .then(response => response.json())
            .then(data => {
                if (data.current_cookie) {
                    imageCookieInput.value = data.current_cookie;
                    currentImageCookieDisplay.textContent = data.current_cookie;
                }
            })
            .catch(error => {
                console.error('è·å–å›¾ç‰‡ä¸‹è½½Cookieå¤±è´¥:', error);
            });

            // æ›´æ–°å›¾ç‰‡ä¸‹è½½CookieæŒ‰é’®ç‚¹å‡»äº‹ä»¶
            updateImageCookieBtn.addEventListener('click', function() {
                const customCookie = imageCookieInput.value.trim();
                
                if (!customCookie) {
                    alert('è¯·è¾“å…¥å›¾ç‰‡ä¸‹è½½Cookieå€¼ï¼');
                    return;
                }
                
                // å‘é€è¯·æ±‚æ›´æ–°å›¾ç‰‡ä¸‹è½½Cookie
                fetch('/update_image_cookie', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: new URLSearchParams({
                        'cookie': customCookie
                    })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        // æ›´æ–°æ˜¾ç¤ºçš„å½“å‰å›¾ç‰‡ä¸‹è½½Cookie
                        currentImageCookieDisplay.textContent = customCookie;
                        alert('å›¾ç‰‡ä¸‹è½½Cookieæ›´æ–°æˆåŠŸï¼');
                    } else {
                        alert('å›¾ç‰‡ä¸‹è½½Cookieæ›´æ–°å¤±è´¥: ' + data.message);
                    }
                })
                .catch(error => {
                    alert('è¯·æ±‚å¤±è´¥: ' + error.message);
                });
            });

            // å¼€å§‹çˆ¬å–
            crawlForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // æ˜¾ç¤ºæš‚åœæŒ‰é’®ï¼Œéšè—å¼€å§‹æŒ‰é’®
                startBtn.style.display = 'none';
                pauseBtn.style.display = 'inline-block';
                resumeBtn.style.display = 'none';
                stopBtn.style.display = 'inline-block';
                downloadBtn.disabled = true;
                downloadUrlsBtn.disabled = true;
                statusText.textContent = 'å‡†å¤‡ä¸­';
                magnetCount.textContent = '0';
                imageCount.textContent = '0';
                magnetFileNameDisplay.textContent = 'æœªç”Ÿæˆ';
                urlFileNameDisplay.textContent = 'æœªç”Ÿæˆ';
                figuresDirDisplay.textContent = 'æœªç”Ÿæˆ';
                progressText.textContent = '0%';
                progressBar.style.width = '0%';
                progressBar.textContent = '0%';
                
                // æ¸…ç©ºå†å²è®°å½•
                historyList.innerHTML = '<li class="list-group-item text-muted">æš‚æ— çˆ¬å–å†å²</li>';
                
                // å‘é€è¯·æ±‚å¼€å§‹çˆ¬å–
                const formData = new FormData(crawlForm);
                fetch('/start_crawl', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'error') {
                        alert(data.message);
                        startBtn.style.display = 'inline-block';
                        pauseBtn.style.display = 'none';
                        stopBtn.style.display = 'none';
                        startBtn.disabled = false;
                    } else {
                        // å¼€å§‹è½®è¯¢çŠ¶æ€
                        pollStatus();
                    }
                })
                .catch(error => {
                    alert('è¯·æ±‚å¤±è´¥: ' + error.message);
                    startBtn.style.display = 'inline-block';
                    pauseBtn.style.display = 'none';
                    stopBtn.style.display = 'none';
                    startBtn.disabled = false;
                });
            });

            // æš‚åœçˆ¬å–
            pauseBtn.addEventListener('click', function() {
                fetch('/pause_crawl')
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        pauseBtn.style.display = 'none';
                        resumeBtn.style.display = 'inline-block';
                    } else {
                        alert('æš‚åœå¤±è´¥: ' + data.message);
                    }
                })
                .catch(error => {
                    alert('è¯·æ±‚å¤±è´¥: ' + error.message);
                });
            });

            // ç»§ç»­çˆ¬å–
            resumeBtn.addEventListener('click', function() {
                fetch('/resume_crawl')
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        resumeBtn.style.display = 'none';
                        pauseBtn.style.display = 'inline-block';
                    } else {
                        alert('ç»§ç»­å¤±è´¥: ' + data.message);
                    }
                })
                .catch(error => {
                    alert('è¯·æ±‚å¤±è´¥: ' + error.message);
                });
            });

            // åœæ­¢çˆ¬å–
            stopBtn.addEventListener('click', function() {
                fetch('/stop_crawl')
                .then(response => response.json())
                .then(data => {
                    if (data.status !== 'success') {
                        alert('åœæ­¢å¤±è´¥: ' + data.message);
                    }
                })
                .catch(error => {
                    alert('è¯·æ±‚å¤±è´¥: ' + error.message);
                });
            });

            // ä¸‹è½½ç»“æœ
            downloadBtn.addEventListener('click', function() {
                window.location.href = '/download';
            });
            
            // ä¸‹è½½çˆ¬å–åœ°å€
            downloadUrlsBtn.addEventListener('click', function() {
                window.location.href = '/download_urls';
            });

            // è¿‡æ»¤åŠŸèƒ½
            magnetFilter.addEventListener('input', function() {
                updateDisplays();
            });
            
            urlFilter.addEventListener('input', function() {
                updateDisplays();
            });
            
            // å¤åˆ¶å…¨éƒ¨ç£åŠ›é“¾æ¥
            copyAllMagnets.addEventListener('click', function() {
                if (magnetLinks.length > 0) {
                    navigator.clipboard.writeText(magnetLinks.join('\n'))
                        .then(() => {
                            alert('å·²å¤åˆ¶å…¨éƒ¨ç£åŠ›é“¾æ¥åˆ°å‰ªè´´æ¿');
                        })
                        .catch(err => {
                            console.error('å¤åˆ¶å¤±è´¥:', err);
                            alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
                        });
                } else {
                    alert('æ²¡æœ‰ç£åŠ›é“¾æ¥å¯ä»¥å¤åˆ¶');
                }
            });
            
            // å¤åˆ¶å…¨éƒ¨çˆ¬å–åœ°å€
            copyAllUrls.addEventListener('click', function() {
                if (crawlUrls.length > 0) {
                    navigator.clipboard.writeText(crawlUrls.join('\n'))
                        .then(() => {
                            alert('å·²å¤åˆ¶å…¨éƒ¨çˆ¬å–åœ°å€åˆ°å‰ªè´´æ¿');
                        })
                        .catch(err => {
                            console.error('å¤åˆ¶å¤±è´¥:', err);
                            alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
                        });
                } else {
                    alert('æ²¡æœ‰çˆ¬å–åœ°å€å¯ä»¥å¤åˆ¶');
                }
            });

            // è½®è¯¢çŠ¶æ€
            let magnetLinks = [];
            let crawlUrls = [];
            
            // è·å–æ˜¾ç¤ºå…ƒç´ 
            const magnetCountDisplay = document.getElementById('magnetCountDisplay');
            const magnetLinksDisplay = document.getElementById('magnetLinksDisplay');
            const urlsCountDisplay = document.getElementById('urlsCountDisplay');
            const crawlUrlsDisplay = document.getElementById('crawlUrlsDisplay');
            
            // æ›´æ–°æ˜¾ç¤ºå†…å®¹çš„å‡½æ•°
            function updateDisplays() {
                // åº”ç”¨å½“å‰è¿‡æ»¤æ¡ä»¶
                const magnetFilterText = magnetFilter.value.toLowerCase();
                const filteredMagnets = magnetFilterText ? magnetLinks.filter(link => link.toLowerCase().includes(magnetFilterText)) : magnetLinks;
                
                // æ›´æ–°ç£åŠ›é“¾æ¥æ˜¾ç¤º
                magnetCountDisplay.textContent = magnetLinks.length;
                if (magnetLinks.length > 0) {
                    magnetLinksDisplay.innerHTML = filteredMagnets.map(link => `
                        <div class="magnet-item mb-2 p-2 bg-secondary bg-opacity-20 rounded">
                            <div class="text-break text-sm">${link}</div>
                            <button class="copy-magnet-btn btn btn-sm btn-primary mt-1" data-magnet="${link}">å¤åˆ¶</button>
                        </div>
                    `).join('');
                    
                    // æ·»åŠ å¤åˆ¶æŒ‰é’®äº‹ä»¶
                    document.querySelectorAll('.copy-magnet-btn').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const magnet = this.getAttribute('data-magnet');
                            navigator.clipboard.writeText(magnet)
                                .then(() => {
                                    this.textContent = 'å·²å¤åˆ¶';
                                    setTimeout(() => {
                                        this.textContent = 'å¤åˆ¶';
                                    }, 2000);
                                })
                                .catch(err => {
                                    console.error('å¤åˆ¶å¤±è´¥:', err);
                                    alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
                                });
                        });
                    });
                } else {
                    magnetLinksDisplay.innerHTML = '<p class="text-muted">æš‚æ— ç£åŠ›é“¾æ¥...</p>';
                }
                
                // åº”ç”¨å½“å‰è¿‡æ»¤æ¡ä»¶
                const urlFilterText = urlFilter.value.toLowerCase();
                const filteredUrls = urlFilterText ? crawlUrls.filter(url => url.toLowerCase().includes(urlFilterText)) : crawlUrls;
                
                // æ›´æ–°çˆ¬å–åœ°å€æ˜¾ç¤º
                urlsCountDisplay.textContent = crawlUrls.length;
                if (crawlUrls.length > 0) {
                    crawlUrlsDisplay.innerHTML = filteredUrls.map(url => `
                        <div class="url-item mb-2 p-2 bg-secondary bg-opacity-20 rounded">
                            <div class="text-break text-sm"><a href="${url}" target="_blank" class="text-primary">${url}</a></div>
                            <button class="copy-url-btn btn btn-sm btn-info mt-1" data-url="${url}">å¤åˆ¶</button>
                        </div>
                    `).join('');
                    
                    // æ·»åŠ å¤åˆ¶æŒ‰é’®äº‹ä»¶
                    document.querySelectorAll('.copy-url-btn').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const url = this.getAttribute('data-url');
                            navigator.clipboard.writeText(url)
                                .then(() => {
                                    this.textContent = 'å·²å¤åˆ¶';
                                    setTimeout(() => {
                                        this.textContent = 'å¤åˆ¶';
                                    }, 2000);
                                })
                                .catch(err => {
                                    console.error('å¤åˆ¶å¤±è´¥:', err);
                                    alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
                                });
                        });
                    });
                } else {
                    crawlUrlsDisplay.innerHTML = '<p class="text-muted">æš‚æ— çˆ¬å–åœ°å€...</p>';
                }
            }

            function renderHistory(history) {
                if (!history || history.length === 0) {
                    historyList.innerHTML = '<li class="list-group-item text-muted">æš‚æ— çˆ¬å–å†å²</li>';
                    return;
                }

                historyList.innerHTML = history.map(item => {
                    const images = item.images || 0;
                    const skipped = item.images_skipped || 0;
                    const imageText = skipped ? `${images} å¼  (è·³è¿‡ ${skipped})` : `${images} å¼ `;
                    const figures = item.figures_dir ? `<div class="small text-muted">å›¾ç‰‡ç›®å½•: ${item.figures_dir}</div>` : '';
                    return `
                        <li class="list-group-item">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <div class="fw-bold">è®ºå› ${item.forum_id} Â· ${item.pages} é¡µ</div>
                                    <div class="small text-muted">${item.timestamp}</div>
                                </div>
                                <div class="text-end">
                                    <div class="small text-info">ç£åŠ›: ${item.magnets}</div>
                                    <div class="small text-info">å›¾ç‰‡: ${imageText}</div>
                                </div>
                            </div>
                            <div class="small text-muted mt-1">ç£åŠ›æ–‡ä»¶: ${item.magnet_file || 'æœªç”Ÿæˆ'}</div>
                            <div class="small text-muted">åœ°å€æ–‡ä»¶: ${item.url_file || 'æœªç”Ÿæˆ'}</div>
                            ${figures}
                        </li>
                    `;
                }).join('');
            }
            function pollStatus() {
                fetch('/crawl_status')
                .then(response => response.json())
                .then(data => {
                    // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
                    const statusLabel = data.running
                        ? (data.paused ? 'å·²æš‚åœ' : 'æ­£åœ¨çˆ¬å–')
                        : (data.progress || data.magnet_count || data.image_count ? 'å·²å®Œæˆ' : 'å°±ç»ª');
                    statusText.textContent = statusLabel;
                    magnetCount.textContent = data.magnet_count;
                    imageCount.textContent = data.image_count || 0;
                    currentPage.textContent = data.current_page;
                    totalPages.textContent = data.total;
                    messageText.textContent = data.message;
                    currentUrl.textContent = data.current_url || '';
                    magnetFileNameDisplay.textContent = data.magnet_file_name || 'æœªç”Ÿæˆ';
                    urlFileNameDisplay.textContent = data.url_file_name || 'æœªç”Ÿæˆ';
                    figuresDirDisplay.textContent = data.figures_dir || 'æœªç”Ÿæˆ';
                    renderHistory(data.history);

                    // æ›´æ–°è¿›åº¦æ¡
                    if (data.total > 0) {
                        const progress = Math.round((data.progress / data.total) * 100);
                        progressText.textContent = progress + '%';
                        progressBar.style.width = progress + '%';
                        progressBar.setAttribute('aria-valuenow', progress);
                        progressBar.textContent = progress + '%';
                    } else {
                        progressText.textContent = '0%';
                        progressBar.style.width = '0%';
                        progressBar.setAttribute('aria-valuenow', 0);
                        progressBar.textContent = '0%';
                    }

                    // æ›´æ–°æŒ‰é’®çŠ¶æ€
                    if (data.running) {
                        startBtn.style.display = 'none';
                        stopBtn.style.display = 'inline-block';
                        if (data.paused) {
                            pauseBtn.style.display = 'none';
                            resumeBtn.style.display = 'inline-block';
                        } else {
                            pauseBtn.style.display = 'inline-block';
                            resumeBtn.style.display = 'none';
                        }
                        downloadBtn.disabled = true;
                        downloadUrlsBtn.disabled = true;
                    } else {
                        startBtn.style.display = 'inline-block';
                        pauseBtn.style.display = 'none';
                        resumeBtn.style.display = 'none';
                        stopBtn.style.display = 'none';
                        startBtn.disabled = false;
                        downloadBtn.disabled = false;
                        downloadUrlsBtn.disabled = false;
                    }

                    // è·å–æœ€æ–°çš„ç£åŠ›é“¾æ¥å’Œçˆ¬å–åœ°å€
                    if (data.running || data.magnet_count > 0) {
                        Promise.all([
                            fetch('/get_magnet_links'),
                            fetch('/get_crawl_urls')
                        ])
                        .then(responses => Promise.all(responses.map(res => res.json())))
                        .then(results => {
                            magnetLinks = results[0];
                            crawlUrls = results[1];
                            updateDisplays();
                        })
                        .catch(error => {
                            console.error('è·å–æ•°æ®å¤±è´¥:', error);
                        });
                    }

                    // å¦‚æœæ­£åœ¨è¿è¡Œï¼Œç»§ç»­è½®è¯¢
                    if (data.running) {
                        setTimeout(pollStatus, 1000);
                    }
                })
                .catch(error => {
                    console.error('è·å–çŠ¶æ€å¤±è´¥:', error);
                    setTimeout(pollStatus, 1000);
                });
            }

            // é¡µé¢åŠ è½½æ—¶æ‹‰å–ä¸€æ¬¡æœ€æ–°çŠ¶æ€/å†å²
            pollStatus();
        });
    </script>
</body>
</html>
